<!DOCTYPE html>

<html>

<head>
  <title>Account</title>
  

  <style>
    body{
      margin:0;
      padding:0;
  }
    #disconnetti{
    font-size: 15px;
    border:0;
    background: none;
    margin: 0 auto;
    text-align: center;
    font-weight: 500;
    border: 2px solid #e74c3c;
    padding: 10px 40px;
    outline: none;
    color:#485460;
    border-radius: 24px;
    transition: 0.25s;
    cursor: pointer;
    float:top;

  
    }
    #disconnetti:hover{
      background: #e74c3c;
      color: white;
    }

    h2{
      height:20px;
      width:auto;
      font-size:16px;
      font-weight: 300;
      background-color: #2c3e50;
      color:rgb(255, 255, 255);
      text-align: center;
      margin: 0 auto;
      vertical-align: middle;
      border-radius: 20px;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
      float: center;
      padding:10px;
      margin:10px;
    }

    h2.email{
      font-size:18px;
      font-weight: 300;
    }

    .logo{
    width:10%;
    text-align: left;
    padding-left:20px;
    font-size: 24px;
    font-weight: 600;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    
  }
  .navbar{
    z-index:1;
    margin: 0 auto;
    padding:0;
    width:100%;
    height:10%;
    background-color: #2c3e50;
    color:white;
    font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-align: center;
    position: fixed;
    float: top;
    box-shadow: 0px 5px 5px 0px rgba(0, 0, 0, 0.5);
}
  h1{
   
      font-size:24px;
      font-weight: 500;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    
  }

  p{
      font-size:18px;
      font-weight: 200;
      font-family:Arial, Helvetica, sans-serif;
  }
    
    #principale{
      text-align: center;
      margin: 0 auto;
      width: 400px;
    }

    form{
      text-align: center;
      margin: 0 auto;
      height:auto;
      width: 400px;
    
     
    }

    a:link { text-decoration: none; }
    a:visited { text-decoration: none; }
    a:hover { text-decoration: none; }
    a:active { text-decoration: none; }
    a{
      color:white;
    }

    td{
    width:20%;
}
  </style>

</head>



<body>



  <table class="navbar">
    <tr>
        <td class = "logo">
            <a href="principale.html" class="home">Gestione Comunit√† Musicali Online</a>
        </td>
        <td>
          <a href="principale.html" >Playlist Private</a>
      </td>
      <td>
          <a href="globali.html" >Playlist Pubbliche</a>
      </td>
        <td style="width:5%">
                        
          <a href="account.html" style="color:white; font-size:13px;">
          <figure>
              <img height="40px" src="profilo.png" alt="profilo"/>
              <figcaption id="nomeProfilo">  </figcaption>
          </figure>
          </a>
      </td>
  
  </table>

      <br><br><br><br><br><br><br><br>

      <div id="principale">
        
      </div>
     
    <br>
      <form >
        <button type="button" id= "disconnetti" onclick="disconnect()">Disconnetti</button>
        
    </form>
    <br>
    <form>
    <button type="button" id= "disconnetti" onclick="elimina()">Elimina</button>
    </form>
<script>

 function disconnect(){
    localStorage.setItem('nome', 0);
    window.location.replace("login.html");
 }


 function elimina(){
 //Eliminazione del profilo dopo la conferma

    if (confirm("Sei sicuro di voler eliminare il tuo profilo?") == true) {
      
      utenti = localStorage.getItem('users');
      utenti = JSON.parse(utenti);
      private = localStorage.getItem('l');
      private = JSON.parse(private);
      pubbliche = localStorage.getItem('pubbliche');
      pubbliche = JSON.parse(pubbliche);

      //Elimino l'utente e tutte le sue playlist private/pubbliche
      for (let i= 0; i<utenti.length; i++) {
        if (utenti[i].nome == sessName) {
          utenti.splice(i, 1);
        }
      }
      for (let i= 0; i<pubbliche.length; i++) {
        if (pubbliche[i].utente == sessName) {
          pubbliche.splice(i, 1);
        }
      }
      for (let i= 0; i<private.length; i++) {
        if (private[i].utente == sessName) {
          private.splice(i, 1);
        }
      }

      localStorage.setItem('users',JSON.stringify(utenti))
      localStorage.setItem('l',JSON.stringify(private))
      localStorage.setItem('pubbliche',JSON.stringify(pubbliche))
    
      alert("Cancellazione avvenuta con successo");

      window.location.replace("login.html");
      
   
    } 

   

 }



  function stampa(){
  //Stampa i dati relativi all'utente dati in fase di registrazione

    document.getElementById('nomeProfilo').innerHTML+=sessName;
    document.getElementById('principale').innerHTML+="<h1>Profilo di "+ sessName 
    + "<br><h1> Email </h1><h2>"+sessEmail+"</h2><h1>Generi Preferiti</h1>";
    

    for(let i = 0; i< listaGeneri.length;i++){
      document.getElementById('principale').innerHTML+="<h2>"+listaGeneri[i]+"</h2>";
    }
    document.getElementById('principale').innerHTML+="<h1>Artisti Preferiti</h1>";
    for(let i = 0; i< listaArtisti.length;i++){
      document.getElementById('principale').innerHTML+="<h2>"+listaArtisti[i]+"</h2>";
    }
    
  }


  //Setto le variabili con i dati dell'utente attuale.
  if(localStorage.getItem('l')!= []){
      var lista = localStorage.getItem('l');
      lista = JSON.parse(lista);
  }

  sessName = localStorage.getItem('nome')
  sessEmail=  localStorage.getItem('email')
  sessGeneri =  localStorage.getItem('generi')
  sessArtisti=  localStorage.getItem('artisti')
  var listaGeneri = sessGeneri.split(',');
  var listaArtisti = sessArtisti.split(',');
  stampa()
  console.log(localStorage)

</script>



</body>













</html>